<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Petasan Jaya</title>

<style>
:root{
--bg:#F2F2F7;--card:#fff;--blue:#007AFF;
--green:#34C759;--red:#FF3B30;--gray:#8E8E93;
}
*{box-sizing:border-box;font-family:-apple-system,sans-serif}
body{margin:0;background:var(--bg);padding-bottom:150px}

/* HEADER */
.header{
background:#fff;padding:12px 15px;display:flex;
align-items:center;gap:10px;
position:sticky;top:0;border-bottom:1px solid #eee;z-index:10
}
.header img{width:36px;height:36px;border-radius:10px;object-fit:cover}
.header h3{margin:0;font-size:18px}

/* BANNER */
.banner{height:200px;background:#333;overflow:hidden}
.banner img{width:100%;height:100%;object-fit:cover}

/* STORE DESC */
.store-desc{
background:#fff;margin:15px;padding:15px;
border-radius:20px;font-size:14px;color:#444;
line-height:1.5
}

/* ADMIN */
.admin{background:#fff;margin:15px;padding:15px;border-radius:20px}
.admin-only{display:none}
input,textarea,select{
width:100%;padding:12px;margin-bottom:10px;
border-radius:10px;border:1px solid #ddd
}

/* PRODUCTS */
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;padding:15px}
.card{background:#fff;border-radius:20px;overflow:hidden;
box-shadow:0 4px 10px rgba(0,0,0,.05)}
.card img{width:100%;height:150px;object-fit:cover;background:#eee}
.info{padding:10px;text-align:center}
.name{font-weight:600;font-size:14px}
.desc{font-size:12px;color:#666;margin:4px 0;height:32px;overflow:hidden}
.price{color:var(--blue);font-weight:800}
.stock,.cat{font-size:12px;color:var(--gray)}

/* BUTTON */
button{border:none;border-radius:12px;padding:10px;font-weight:700;cursor:pointer}
.buy{background:var(--green);color:#fff;width:100%;margin-top:5px}
.cart{background:#f2f2f7;color:var(--blue);width:100%;margin-top:5px}

/* CART */
#cartBar{
position:fixed;bottom:20px;left:15px;right:15px;
background:var(--green);color:#fff;padding:15px;
border-radius:20px;display:none;
justify-content:space-between;font-weight:800
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
<img id="logoImg" style="display:none">
<h3 id="storeName">Petasan Jaya üéÜ</h3>
<button onclick="loginAdmin()" style="margin-left:auto">üîí</button>
</div>

<!-- BANNER -->
<div class="banner">
<img id="bannerImg" style="display:none">
</div>

<!-- DESKRIPSI TOKO -->
<div class="store-desc" id="storeDesc">
Menjual petasan & kembang api berkualitas, aman, dan terpercaya.
</div>

<!-- ADMIN PANEL -->
<div class="admin admin-only">
<h3>üõ†Ô∏è Admin Toko</h3>

<label>Nama Toko</label>
<input id="storeNameInput">

<label>Deskripsi Toko</label>
<textarea id="storeDescInput"
placeholder="Deskripsi singkat tentang toko"></textarea>

<label>Logo</label>
<input type="file" accept="image/*" onchange="uploadLogo(event)">

<label>Banner</label>
<input type="file" accept="image/*" onchange="uploadBanner(event)">

<button onclick="saveStore()" style="background:var(--blue);color:#fff">
Simpan Profil Toko
</button>

<hr>

<input id="pName" placeholder="Nama Petasan">
<textarea id="pDesc" placeholder="Deskripsi Produk"></textarea>
<input id="pPrice" type="number" placeholder="Harga">
<input id="pStock" type="number" placeholder="Stok">

<select id="pCat">
<option value="">Kategori</option>
<option>Petasan Banting</option>
<option>Petasan Renteng</option>
<option>Petasan Roket</option>
<option>Kembang Api</option>
</select>

<input type="file" id="pImg" accept="image/*">

<button onclick="addProduct()" style="background:var(--green);color:#fff">
Simpan Produk
</button>
</div>

<!-- PRODUCT LIST -->
<div class="grid" id="list"></div>

<!-- CART BAR -->
<div id="cartBar" onclick="checkoutWA()">
<span id="cartText">üßæ 0 Item</span>
<span>Checkout ‚ûú</span>
</div>

<script>
const KEY="PETASAN_STORE_V3";
const WA="085697334082; // GANTI NOMOR WA
const ADMIN_PASS="martin123";

let db={
store:{name:"Petasan Jaya üéÜ",desc:"Menjual petasan & kembang api berkualitas, aman, dan terpercaya.",logo:"",banner:""},
products:[]
};
let admin=false,cart={};

function load(){
const d=localStorage.getItem(KEY);
if(d) db=JSON.parse(d);
applyStore();render();
}
function save(){localStorage.setItem(KEY,JSON.stringify(db));}

/* ADMIN */
function loginAdmin(){
if(prompt("Password Admin")!==ADMIN_PASS) return alert("Password salah");
admin=!admin;
document.querySelectorAll(".admin-only")
.forEach(e=>e.style.display=admin?"block":"none");

storeNameInput.value=db.store.name;
storeDescInput.value=db.store.desc;
}

/* STORE */
function applyStore(){
storeName.innerText=db.store.name;
storeDesc.innerText=db.store.desc;
if(db.store.logo){logoImg.src=db.store.logo;logoImg.style.display="block";}
if(db.store.banner){bannerImg.src=db.store.banner;bannerImg.style.display="block";}
}

function saveStore(){
db.store.name=storeNameInput.value;
db.store.desc=storeDescInput.value;
save();applyStore();
}

/* UPLOAD */
function uploadLogo(e){
const r=new FileReader();
r.onload=()=>{db.store.logo=r.result;save();applyStore()}
r.readAsDataURL(e.target.files[0]);
}
function uploadBanner(e){
const r=new FileReader();
r.onload=()=>{db.store.banner=r.result;save();applyStore()}
r.readAsDataURL(e.target.files[0]);
}

/* PRODUCT */
function addProduct(){
const n=pName.value,d=pDesc.value,pr=pPrice.value,st=pStock.value,c=pCat.value,f=pImg.files[0];
if(!n||!d||!pr||!st||!c||!f) return alert("Lengkapi data");
const r=new FileReader();
r.onload=()=>{
db.products.push({id:Date.now(),name:n,desc:d,price:+pr,stock:+st,cat:c,img:r.result});
save();render();
};
r.readAsDataURL(f);
}

/* CART */
function addCart(id){cart[id]=(cart[id]||0)+1;updateCart()}
function updateCart(){
let t=Object.values(cart).reduce((a,b)=>a+b,0);
cartBar.style.display=t?"flex":"none";
cartText.innerText=`üßæ ${t} Item`;
}

/* WA */
function buyNow(p){
let msg=`Halo, saya mau beli:\n${p.name}\n${p.desc}\nHarga: Rp ${p.price.toLocaleString()}`;
open(`https://wa.me/${WA}?text=${encodeURIComponent(msg)}`);
}
function checkoutWA(){
let msg="Halo, saya pesan:\n",total=0;
for(let id in cart){
const p=db.products.find(x=>x.id==id);
const sub=p.price*cart[id];
total+=sub;
msg+=`- ${p.name} (${cart[id]}x) Rp ${sub.toLocaleString()}\n`;
}
msg+=`\nTotal: Rp ${total.toLocaleString()}`;
open(`https://wa.me/${WA}?text=${encodeURIComponent(msg)}`);
}

/* RENDER */
function render(){
list.innerHTML=db.products.map(p=>`
<div class="card">
<img src="${p.img}">
<div class="info">
<div class="name">${p.name}</div>
<div class="desc">${p.desc}</div>
<div class="cat">${p.cat}</div>
<div class="price">Rp ${p.price.toLocaleString()}</div>
<div class="stock">Stok: ${p.stock}</div>
<button class="buy" onclick='buyNow(${JSON.stringify(p)})'>Beli via WhatsApp</button>
<button class="cart" onclick="addCart(${p.id})">+ Keranjang</button>
</div>
</div>`).join("");
}

window.onload=load;
</script>

</body>
</html>
